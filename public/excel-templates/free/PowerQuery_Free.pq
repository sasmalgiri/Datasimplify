// ==============================================
// CryptoReportKit - FREE STARTER TEMPLATE
// Power Query for Excel (BYOK)
// ==============================================
//
// ‚≠ê FREE TIER - 10 Coins, Basic Features
//
// To upgrade: https://cryptoreportkit.com/pricing
//
// DATA SOURCE:
// Data provided by CoinGecko (https://www.coingecko.com/en/api)
// CoinGecko API is used under their free tier with attribution.
//
// ==============================================

// HOW TO USE:
// 1. In Excel: Data ‚Üí Get Data ‚Üí From Web
// 2. Paste the URL below
// 3. Click OK ‚Üí Close & Load
//
// API URL (copy this):
// https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=bitcoin,ethereum,solana,cardano,ripple,dogecoin,polkadot,avalanche-2,chainlink,polygon&order=market_cap_desc

// ---------------------------------------------
// POWER QUERY CODE (Advanced Editor)
// ---------------------------------------------
let
    // FREE: Limited to 10 coins
    // Upgrade to Pro for 100+ coins: https://cryptoreportkit.com/pricing
    
    CoinIds = "bitcoin,ethereum,solana,cardano,ripple,dogecoin,polkadot,avalanche-2,chainlink,polygon",
    
    Source = Json.Document(Web.Contents(
        "https://api.coingecko.com/api/v3/coins/markets",
        [
            Query = [
                vs_currency = "usd",
                ids = CoinIds,
                order = "market_cap_desc",
                sparkline = "false"
            ]
        ]
    )),
    
    ToTable = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    
    ExpandedColumns = Table.ExpandRecordColumn(ToTable, "Column1", 
        {"name", "symbol", "current_price", "price_change_percentage_24h", "market_cap"},
        {"Coin", "Symbol", "Price_USD", "Change_24h", "Market_Cap"}),
    
    TypedTable = Table.TransformColumnTypes(ExpandedColumns, {
        {"Price_USD", type number},
        {"Change_24h", type number},
        {"Market_Cap", Int64.Type}
    }),
    
    // Add timestamp
    AddTimestamp = Table.AddColumn(TypedTable, "Last_Updated", each DateTime.LocalNow())
in
    AddTimestamp

// ---------------------------------------------
// WANT MORE FEATURES?
// ---------------------------------------------
// 
// üöÄ PRO TEMPLATE ($29) includes:
//    ‚úÖ Top 100 cryptocurrencies
//    ‚úÖ Auto-refresh every 5 minutes
//    ‚úÖ Portfolio tracker
//    ‚úÖ Interactive charts
//    ‚úÖ DCA calculator
//    ‚úÖ BYOK with CoinGecko Pro API
//
// üè¢ ENTERPRISE TEMPLATE ($99) includes:
//    ‚úÖ All 10,000+ cryptocurrencies
//    ‚úÖ Historical data (5 years)
//    ‚úÖ Risk analytics (Sharpe ratio, etc.)
//    ‚úÖ Correlation matrix
//    ‚úÖ Custom modifications
//
// Upgrade: https://cryptoreportkit.com/pricing
// ---------------------------------------------

// NEED HIGHER API LIMITS?
// Get CoinGecko Pro: https://www.coingecko.com/api/pricing?ref=cryptoreportkit
// (Affiliate link - helps support this project!)
